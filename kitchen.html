<!DOCTYPE html>
<html lang="en">
<head>
    <title>GI-shop - Groceries</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="icon/x-image" href="/CaseStudy/image.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .section1 {
            margin: 100px;
        }
        button {
            padding: 10px;
            border: 1px solid;
            border-radius: 5px;
            cursor: pointer;
            background-color: rgb(203, 30, 30);
            color: white;
        }
        a {
            text-decoration: none;
            color: white;
        }
        #back {
            margin: 10px;
        }
        .stock-info {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
        .low-stock {
            color: #dc3545;
            font-weight: bold;
        }
        .out-of-stock {
            color: #dc3545;
            font-weight: bold;
        }
        .card-footer {
            background: transparent;
            border-top: none;
        }
    </style>
</head>
<body>
    <button id="back"><a href="/CaseStudy/mainpage.html">ðŸ”™ Back</a></button>
    <button id="stock-manage"><a href="stock.html">ðŸ“¦ Manage Stock</a></button>

    <section class="section1">
        <div class="row row-cols-1 row-cols-md-3 g-4">
            <!-- Wheat Flour -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://5.imimg.com/data5/SELLER/Default/2022/10/EL/VH/SG/152691664/1-1000x1000.jpg" class="card-img-top" alt="Wheat flour">
                    <div class="card-body">
                        <h5 class="card-title">Wheat flour</h5>
                        <p class="card-text">Finely milled wheat flour for soft rotis.</p>
                        <p>Cost: â‚¹<span class="price">7824</span></p>
                        <div class="stock-info" id="wheat-flour-stock"></div>
                    </div>
                    <button onclick="addToCart('Wheat flour', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Tahini Oil -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://www.designerpeople.com/wp-content/uploads/2019/09/amazing-edible-oil-sticker-design-4.jpg" class="card-img-top" alt="Oil">
                    <div class="card-body">
                        <h5 class="card-title">Tahini Oil</h5>
                        <p class="card-text">Pure and healthy cooking oil for every meal.</p>
                        <p>Cost: â‚¹<span class="price">6203</span></p>
                        <div class="stock-info" id="tahini-oil-stock"></div>
                    </div>
                    <button onclick="addToCart('Tahini Oil', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Rice -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://th.bing.com/th/id/OIP.F7wD-xfUaxvqU_8_VoJvoAHaHa?rs=1&pid=ImgDetMain" class="card-img-top" alt="Rice">
                    <div class="card-body">
                        <h5 class="card-title">Rice</h5>
                        <p class="card-text">Premium quality rice for perfect dishes.</p>
                        <p>Cost: â‚¹<span class="price">9210</span></p>
                        <div class="stock-info" id="rice-stock"></div>
                    </div>
                    <button onclick="addToCart('Rice', this)">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <section class="section1">
        <div class="row row-cols-1 row-cols-md-3 g-4">
            <!-- Dal -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://as2.ftcdn.net/v2/jpg/02/05/63/27/1000_F_205632770_WETUw0nzvJcMJtuVLDVdYBbTiuqlkPC6.jpg" class="card-img-top" alt="Dal">
                    <div class="card-body">
                        <h5 class="card-title">Dal</h5>
                        <p class="card-text">Protein-rich dal for a wholesome diet.</p>
                        <p>Cost: â‚¹<span class="price">4850</span></p>
                        <div class="stock-info" id="dal-stock"></div>
                    </div>
                    <button onclick="addToCart('Dal', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Dry Fruits -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://rukminim1.flixcart.com/image/832/832/kirr24w0-0/nut-dry-fruit/o/7/o/1500-foods-premium-quality-dry-fruits-combo-pack-plastic-bottle-original-imafyhgujfgsvszb.jpeg?q=70" class="card-img-top" alt="Dry fruits (combo)">
                    <div class="card-body">
                        <h5 class="card-title">Dry fruits (combo)</h5>
                        <p class="card-text">Nutritious dry fruits for a healthy snack.</p>
                        <p>Cost: â‚¹<span class="price">7450</span></p>
                        <div class="stock-info" id="dry-fruits-combo-stock"></div>
                    </div>
                    <button onclick="addToCart('Dry fruits (combo)', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Eggs -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://parade.com/.image/t_share/MTk2NjczNTQwOTMyNTExNTUw/how-to-tell-if-eggs-are-bad.jpg" class="card-img-top" alt="Eggs">
                    <div class="card-body">
                        <h5 class="card-title">Eggs</h5>
                        <p class="card-text">Farm-fresh eggs packed with protein.</p>
                        <p>Cost: â‚¹<span class="price">5307</span></p>
                        <div class="stock-info" id="eggs-stock"></div>
                    </div>
                    <button onclick="addToCart('Eggs', this)">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Initialize stock if not exists
        document.addEventListener("DOMContentLoaded", function() {
            if (!localStorage.getItem("stock")) {
                const initialStock = {
                    "Wheat flour": 2500,
                    "Tahini Oil": 1800,
                    "Rice": 3000,
                    "Dal": 2000,
                    "Dry fruits (combo)": 1500,
                    "Eggs": 2800
                };
                localStorage.setItem("stock", JSON.stringify(initialStock));
            }
            updateStockDisplay();
        });

        function updateStockDisplay() {
            const stock = JSON.parse(localStorage.getItem("stock")) || {};
            const products = [
                {name: "Wheat flour", id: "wheat-flour-stock"},
                {name: "Tahini Oil", id: "tahini-oil-stock"},
                {name: "Rice", id: "rice-stock"},
                {name: "Dal", id: "dal-stock"},
                {name: "Dry fruits (combo)", id: "dry-fruits-combo-stock"},
                {name: "Eggs", id: "eggs-stock"}
            ];
            
            products.forEach(product => {
                const element = document.getElementById(product.id);
                if (element) {
                    const quantity = stock[product.name] || 0;
                    
                    if (quantity <= 0) {
                        element.textContent = "Out of Stock";
                        element.className = "stock-info out-of-stock";
                        document.querySelectorAll(`button[onclick*="${product.name.replace('(', '\\(').replace(')', '\\)')}"]`).forEach(btn => {
                            btn.disabled = true;
                            btn.style.backgroundColor = "#cccccc";
                            btn.style.cursor = "not-allowed";
                        });
                    } else {
                        element.textContent = `In Stock: ${quantity}`;
                        element.className = quantity < 100 ? "stock-info low-stock" : "stock-info";
                    }
                }
            });
        }

        function addToCart(name, button) {
            const stock = JSON.parse(localStorage.getItem("stock")) || {};
            
            // Check stock availability
            if (stock[name] <= 0) {
                alert(`${name} is out of stock!`);
                return;
            }

            // Get product details
            const card = button.closest('.card');
            const price = parseFloat(card.querySelector('.price').textContent);
            const imgSrc = card.querySelector('img').src;

            // Update cart
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const existingItem = cart.find(item => item.name === name);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    name: name,
                    price: price,
                    imgSrc: imgSrc,
                    quantity: 1
                });
            }
            
            // Update stock
            stock[name]--;
            localStorage.setItem('stock', JSON.stringify(stock));
            localStorage.setItem('cart', JSON.stringify(cart));
            
            // Update display
            updateStockDisplay();
            alert(`${name} has been added to your cart! ${stock[name]} remaining in stock.`);
        }
    </script>
</body>
</html>