<!DOCTYPE html>
<html>
<head>
    <title>Stock Inventory</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" type="icon/x-image" href="/CaseStudy/image.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container { margin-top: 50px; }
        .stock-actions { display: flex; gap: 10px; margin-top: 20px; }
        .add-stock-btn { margin-bottom: 20px; }
        .quantity-options { display: none; margin-top: 10px; }
        .quantity-options.show { display: flex; flex-wrap: wrap; gap: 5px; }
        .quantity-btn { margin-right: 5px; margin-bottom: 5px; }
        .low-stock-row { background-color: #ffecec; }
        .out-of-stock-row { background-color: #ffcccc; text-decoration: line-through; }
        h2 { color: rgb(203, 30, 30); margin-bottom: 20px; }
        .btn-primary { background-color: rgb(203, 30, 30); border-color: rgb(203, 30, 30); }
        .category-header { 
            background-color: #f8f9fa;
            font-weight: bold;
            font-size: 1.2rem;
            padding: 10px;
            margin-top: 20px;
            border-left: 5px solid rgb(203, 30, 30);
        }
        .no-products { color: #666; font-style: italic; }
        button {
            margin: 5px;
            padding: 10px;
            border: 1px solid;
            border-radius: 5px;
            cursor: pointer;
            background-color: rgb(203, 30, 30);
            color: white;
        }

        a {
            text-decoration: none;
            color: white;
        }
    </style>
</head>
<body>
    <button id="back"><a href="/CaseStudy/frames.html">ðŸ”™ Back</a></button>
    <div class="container">
        <h2>Stock Inventory Management</h2>
        <button class="btn btn-primary add-stock-btn" onclick="toggleQuantityOptions()">âž• Add Stock</button>
        <div id="quantityOptions" class="quantity-options">
            <button class="btn btn-secondary quantity-btn" onclick="addStock(50)">+50</button>
            <button class="btn btn-secondary quantity-btn" onclick="addStock(100)">+100</button>
            <button class="btn btn-secondary quantity-btn" onclick="addStock(300)">+300</button>
            <button class="btn btn-secondary quantity-btn" onclick="addStock(500)">+500</button>
            <input type="number" id="customQuantity" placeholder="Custom amount" style="width: 120px; padding: 5px;">
            <button class="btn btn-secondary quantity-btn" onclick="addCustomStock()">Add Custom</button>
        </div>
        
        <table class="table table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>Product</th>
                    <th>Current Stock</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="stockTable">
                <!-- Content will be generated by JavaScript -->
            </tbody>
        </table>
    </div>

    <script>
        let selectedProduct = null;
        
        // Load all products from localStorage or initialize
        function getAllProducts() {
            let stock = JSON.parse(localStorage.getItem("stock")) || {};
            
            // If empty, initialize with all possible products
            if (Object.keys(stock).length === 0) {
                stock = {
                    // Grocery Items
                    "Wheat flour": 2500,
                    "Tahini Oil": 1800,
                    "Rice": 3000,
                    "Dal": 2000,
                    "Dry fruits (combo)": 1500,
                    "Eggs": 2800,
                    
                    // Dairy Items
                    "Paneer": 2000,
                    "Milk": 3000,
                    "Curd": 2500,
                    "Ghee": 1800,
                    "Cheese": 2200,
                    "Butter": 2000,
                    
                    // Fruits
                    "Banana": 3200,
                    "Apple": 2500,
                    "Strawberry": 1800,
                    "Oranges": 2200,
                    "Fruits (combo)": 1500,
                    "Black, Red Berries": 1200,
                    
                    // Snacks
                    "Lays": 1500,
                    "Devilishly Spicy Chex Mix": 1200,
                    "Gourmet Chocolates": 2000,
                    "Samosa": 1800,
                    "Biscates": 1600,
                    "Sweets": 2200,
                    
                    // Spices
                    "Cloves": 1200,
                    "Turmeric": 1500,
                    "Pepper": 1800,
                    "Black Chili": 1000,
                    "Garlic Powder": 2500,
                    "Saffron": 3000
                };
                localStorage.setItem("stock", JSON.stringify(stock));
            }
            
            return stock;
        }
        
        function loadStock() {
            let stockTable = document.getElementById("stockTable");
            let stock = getAllProducts();
            stockTable.innerHTML = "";
            
            // Define categories and their products
            const categories = [
                {
                    name: "Grocery",
                    products: ["Wheat flour", "Tahini Oil", "Rice", "Dal", "Dry fruits (combo)", "Eggs"]
                },
                {
                    name: "Dairy",
                    products: ["Paneer", "Milk", "Curd", "Ghee", "Cheese", "Butter"]
                },
                {
                    name: "Fruits",
                    products: ["Banana", "Apple", "Strawberry", "Oranges", "Fruits (combo)", "Black, Red Berries"]
                },
                {
                    name: "Snacks",
                    products: ["Lays", "Devilishly Spicy Chex Mix", "Gourmet Chocolates", "Samosa", "Biscates", "Sweets"]
                },
                {
                    name: "Spices",
                    products: ["Cloves", "Turmeric", "Pepper", "Black Chili", "Garlic Powder", "Saffron"]
                }
            ];
            
            // Sort products alphabetically within each category
            categories.forEach(category => {
                category.products.sort();
            });
            
            // Generate table rows with category headers
            categories.forEach(category => {
                // Add category header
                stockTable.innerHTML += `
                    <tr class="category-header">
                        <td colspan="4">${category.name}</td>
                    </tr>
                `;
                
                // Add products for this category
                let hasProducts = false;
                
                category.products.forEach(product => {
                    const quantity = stock[product] || 0;
                    let status = "In Stock";
                    let rowClass = "";
                    
                    if (quantity <= 0) {
                        status = "Out of Stock";
                        rowClass = "out-of-stock-row";
                    } else if (quantity < 100) {
                        status = "Low Stock";
                        rowClass = "low-stock-row";
                    }
                    
                    stockTable.innerHTML += `
                        <tr class="${rowClass}">
                            <td>${product}</td>
                            <td>${quantity}</td>
                            <td>${status}</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" onclick="selectProduct('${product}')">
                                    Select to Add
                                </button>
                            </td>
                        </tr>
                    `;
                    
                    hasProducts = true;
                });
                
                if (!hasProducts) {
                    stockTable.innerHTML += `
                        <tr>
                            <td colspan="4" class="no-products">No products in this category</td>
                        </tr>
                    `;
                }
            });
        }
        
        function selectProduct(product) {
            selectedProduct = product;
            document.querySelector('.add-stock-btn').textContent = `âž• Add Stock to ${product}`;
            document.getElementById('quantityOptions').classList.add('show');
        }
        
        function toggleQuantityOptions() {
            if (!selectedProduct) {
                alert("Please select a product first");
                return;
            }
            const options = document.getElementById('quantityOptions');
            options.classList.toggle('show');
        }
        
        function addStock(quantity) {
            if (!selectedProduct) {
                alert("Please select a product first");
                return;
            }
            
            let stock = getAllProducts();
            stock[selectedProduct] += quantity;
            localStorage.setItem("stock", JSON.stringify(stock));
            
            alert(`Added ${quantity} to ${selectedProduct}. New stock: ${stock[selectedProduct]}`);
            loadStock();
            document.getElementById('quantityOptions').classList.remove('show');
        }
        
        function addCustomStock() {
            const customQuantity = parseInt(document.getElementById('customQuantity').value);
            if (isNaN(customQuantity)) {
                alert("Please enter a valid number");
                return;
            }
            addStock(customQuantity);
            document.getElementById('customQuantity').value = "";
        }
        
        document.addEventListener("DOMContentLoaded", function() {
            loadStock();
        });
    </script>
</body>
</html>