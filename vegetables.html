<!DOCTYPE html> 
<html>

<head>
    <title>GI-shop</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" type="icon/x-image" href="/CaseStudy/image.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .section1 { margin: 100px; }
        button { padding: 10px; border: 1px solid; border-radius: 5px; cursor: pointer; background-color: rgb(203, 30, 30); color: white; }
        a { text-decoration: none; color: white; }
        #back { margin: 10px; }
        .stock-info { color: #666; font-size: 0.9em; margin-top: 5px; }
        .low-stock { color: #dc3545; }
    </style>
</head>

<body>
    <button id="back"><a href="/CaseStudy/mainpage.html">ðŸ”™ Back</a></button>
    <button id="stock-manage" style="margin-left: 10px;"><a href="stock.html">ðŸ“¦ Manage Stock</a></button>

    <section class="section1">
        <div class="row row-cols-1 row-cols-md-3 g-4">
            <!-- Brinjal -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://th.bing.com/th/id/OIP.zc7ca0rAj6qa9E6WEF8pDgHaHa?rs=1&pid=ImgDetMain" class="card-img-top" alt="Brinjal">
                    <div class="card-body">
                        <h5 class="card-title">Brinjal - â‚¹5000</h5>
                        <p class="card-text">Fresh and tender brinjals for tasty dishes.</p>
                        <div class="stock-info" id="brinjal-stock"></div>
                    </div>
                    <button onclick="addToCart('Brinjal', '5000', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Tomato -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://th.bing.com/th/id/OIP.JMRIOYp2jmlICSlEma_3gQHaE7?rs=1&pid=ImgDetMain" class="card-img-top" alt="Tomato">
                    <div class="card-body">
                        <h5 class="card-title">Tomato - â‚¹6000</h5>
                        <p class="card-text">Juicy and ripe tomatoes for rich flavors.</p>
                        <div class="stock-info" id="tomato-stock"></div>
                    </div>
                    <button onclick="addToCart('Tomato', '6000', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Bottle Gourd -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://cdn.pixabay.com/photo/2017/10/02/16/30/pumpkin-2809284_1280.jpg" class="card-img-top" alt="Bottle Gourd">
                    <div class="card-body">
                        <h5 class="card-title">Bottle Gourd - â‚¹7500</h5>
                        <p class="card-text">Nutritious bottle gourd for healthy meals.</p>
                        <div class="stock-info" id="bottle-gourd-stock"></div>
                    </div>
                    <button onclick="addToCart('Bottle Gourd', '7500', this)">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section1">
        <div class="row row-cols-1 row-cols-md-3 g-4">
            <!-- Mirchi -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://static.toiimg.com/photo/71877128.cms" class="card-img-top" alt="Mirchi">
                    <div class="card-body">
                        <h5 class="card-title">Mirchi - â‚¹4800</h5>
                        <p class="card-text">Spicy and fresh chilies to enhance taste.</p>
                        <div class="stock-info" id="mirchi-stock"></div>
                    </div>
                    <button onclick="addToCart('Mirchi', '4800', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Peas -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://th.bing.com/th/id/OIP.AzGRUfXU-3qHKhPsLy4tbwHaFj" class="card-img-top" alt="Peas">
                    <div class="card-body">
                        <h5 class="card-title">Peas - â‚¹9100</h5>
                        <p class="card-text">Sweet and tender peas for perfect recipes.</p>
                        <div class="stock-info" id="peas-stock"></div>
                    </div>
                    <button onclick="addToCart('Peas', '9100', this)">Add to Cart</button>
                </div>
            </div>
            
            <!-- Leafy Vegetables -->
            <div class="col">
                <div class="card h-100">
                    <img src="https://th.bing.com/th/id/OIP.3XqWLC2239Qh9yRNp6WmlQHaEK" class="card-img-top" alt="Leafy Vegetables">
                    <div class="card-body">
                        <h5 class="card-title">Leafy Vegetables - â‚¹6800</h5>
                        <p class="card-text">Green and fresh leaves for a healthy diet.</p>
                        <div class="stock-info" id="leafy-vegetables-stock"></div>
                    </div>
                    <button onclick="addToCart('Leafy Vegetables', '6800', this)">Add to Cart</button>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Initialize stock if not exists
        if (!localStorage.getItem("stock")) {
            const initialStock = {
                "Brinjal": 1200,
                "Tomato": 1500,
                "Bottle Gourd": 1800,
                "Mirchi": 1000,
                "Peas": 2500,
                "Leafy Vegetables": 3000
            };
            localStorage.setItem("stock", JSON.stringify(initialStock));
        }

        // Display stock on page load
        document.addEventListener("DOMContentLoaded", function() {
            updateStockDisplay();
        });

        function updateStockDisplay() {
            const stock = JSON.parse(localStorage.getItem("stock"));
            
            // Update display for each product
            document.getElementById("brinjal-stock").textContent = `In Stock: ${stock["Brinjal"]}`;
            document.getElementById("tomato-stock").textContent = `In Stock: ${stock["Tomato"]}`;
            document.getElementById("bottle-gourd-stock").textContent = `In Stock: ${stock["Bottle Gourd"]}`;
            document.getElementById("mirchi-stock").textContent = `In Stock: ${stock["Mirchi"]}`;
            document.getElementById("peas-stock").textContent = `In Stock: ${stock["Peas"]}`;
            document.getElementById("leafy-vegetables-stock").textContent = `In Stock: ${stock["Leafy Vegetables"]}`;
            
            // Check for low stock and highlight
            for (const item in stock) {
                const elementId = `${item.toLowerCase().replace(' ', '-')}-stock`;
                const element = document.getElementById(elementId);
                if (element && stock[item] < 100) {
                    element.classList.add("low-stock");
                } else if (element) {
                    element.classList.remove("low-stock");
                }
            }
        }

        function addToCart(name, price, button) {
            let stock = JSON.parse(localStorage.getItem("stock"));
            if (stock[name] <= 0) {
                alert(`${name} is out of stock!`);
                return;
            }

            let imgSrc = button.closest('.card').querySelector('img').src;
            let item = { name: name, price: parseFloat(price), imgSrc: imgSrc, quantity: 1 };
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let existingItem = cart.find(cartItem => cartItem.name === name);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push(item);
            }
            
            // Reduce stock
            stock[name]--;
            localStorage.setItem('stock', JSON.stringify(stock));
            localStorage.setItem('cart', JSON.stringify(cart));
            
            updateStockDisplay();
            alert(`${name} has been added to your cart! ${stock[name]} remaining in stock.`);
        }
    </script>
</body>
</html>